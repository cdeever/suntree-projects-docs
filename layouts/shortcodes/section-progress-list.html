{{- $docsPage := .Page.Site.GetPage "/docs" -}}
{{- range $docsPage.Sections -}}
<div style="margin-bottom: 1.5em;">
  <h4 style="margin-bottom: 0.3em;"><a href="{{ .RelPermalink }}">{{ .Title }}</a></h4>
  {{- $completed := 0 -}}
  {{- $in_progress := 0 -}}
  {{- $planned := 0 -}}
  {{- range .Pages -}}
    {{- $completed = add $completed (.Params.tasks_completed | default 0) -}}
    {{- $in_progress = add $in_progress (.Params.tasks_in_progress | default 0) -}}
    {{- $planned = add $planned (.Params.tasks_planned | default 0) -}}
  {{- end -}}
  {{/* Also count tasks on section _index pages */}}
  {{- $completed = add $completed (.Params.tasks_completed | default 0) -}}
  {{- $in_progress = add $in_progress (.Params.tasks_in_progress | default 0) -}}
  {{- $planned = add $planned (.Params.tasks_planned | default 0) -}}
  {{- partial "progress-bar.html" (dict "completed" $completed "in_progress" $in_progress "planned" $planned) -}}
</div>
{{- end -}}
